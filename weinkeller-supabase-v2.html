<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>üç∑ Weinkeller</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: -apple-system, BlinkMacSystemFont, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding-bottom: 80px;
        }
        .header {
            background: rgba(0,0,0,0.3);
            backdrop-filter: blur(10px);
            color: white;
            padding: 20px;
            text-align: center;
            position: sticky;
            top: 0;
            z-index: 100;
        }
        #status { font-size: 0.9em; margin-top: 5px; }
        .loading { color: white; text-align: center; padding: 40px; }
    </style>
</head>
<body>
    <div class="header">
        <h1>üç∑ Weinkeller</h1>
        <div id="status">Teste Verbindung...</div>
    </div>
    <div class="loading" id="content">Lade...</div>

    <script type="module">
        import { createClient } from 'https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2/+esm'
        
        const URL = 'https://cdxmdavnspgczenhgjmk.supabase.co'
        const KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImNkeG1kYXZuc3BnY3plbmhnam1rIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NzExMDI2NDEsImV4cCI6MjA4NjY3ODY0MX0.HgoScNFXdOTFKmPn5lJuh7V0GAoABPz61p1JcjDovbE'
        
        const client = createClient(URL, KEY)
        
        async function test() {
            try {
                document.getElementById('status').textContent = 'Verbinde...'
                
                const { data, error } = await client
                    .from('weine')
                    .select('*')
                    .limit(5)
                
                if (error) throw error
                
                document.getElementById('status').textContent = `‚úÖ ${data.length} Weine geladen`
                document.getElementById('content').innerHTML = `
                    <div style="color: white; padding: 20px;">
                        <h2>Verbindung erfolgreich! ‚úÖ</h2>
                        <p>Erste ${data.length} Weine:</p>
                        <ul style="text-align: left; margin: 20px auto; max-width: 400px;">
                            ${data.map(w => `<li>${w.position} - ${w.weinname}</li>`).join('')}
                        </ul>
                        <p>Die Vollversion kommt gleich...</p>
                    </div>
                `
            } catch (e) {
                document.getElementById('status').textContent = '‚ùå Fehler'
                document.getElementById('content').innerHTML = `
                    <div style="color: #ff6b6b; padding: 20px;">
                        <h2>Fehler beim Laden</h2>
                        <p>${e.message}</p>
                        <pre style="background: rgba(0,0,0,0.3); padding: 15px; border-radius: 10px; margin-top: 20px; text-align: left; overflow-x: auto;">${e.stack}</pre>
                    </div>
                `
            }
        }
        
        test()
    </script>
</body>
</html>
